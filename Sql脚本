WITH CTE AS (
    SELECT *,
           LAG(OhiId) OVER (ORDER BY SomeColumn) AS PreviousOhiId,
           LAG(OrderSource) OVER (ORDER BY SomeColumn) AS PreviousOrderSource,
           LAG(CustomerPoNumber) OVER (ORDER BY SomeColumn) AS PreviousCustomerPoNumber
    FROM YourTable
)
UPDATE CTE
SET OhiId = CASE WHEN PreviousOrderSource = OrderSource AND PreviousCustomerPoNumber = CustomerPoNumber THEN PreviousOhiId ELSE OhiId END;

